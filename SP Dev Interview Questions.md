### Questions Without Answers

1. How to change a classic site to a modern site?
2. How to create a modern site template? What are the ways to create it?
3. How can we use CQWP/CEWP in a modern page?
4. What is the search configuration in a modern site?
5. How do we get the current user's manager in SPFX?
6. How do we pass a value from one child component to another child component?
7. If I have to deploy different code to UAT and Prod in a CI/CD pipeline, what is the option?
8. How do we display an alert message if a user belongs to the Contribute group and not display it if they belong to another group? What should be the approach—App Customizer or Web Part in SPFX?
9. How do we display the user name in the "Modified By" field on an auto-triggered Power Automate email?
10. How do we call an Azure Function in SPFX code?
11. How do we call a restricted Azure API in SPFX?
12. Where do you set the URL for debugging SPFX code?
13. What files are available in an SPFX solution, mainly in the config folder, and what are their uses?
14. What are React Hooks?
15. How do you manage a large solution in SPFX?
16. How do you restrict data from accessing region-specific data (e.g., USA-specific data should not be accessed from India) in an API?
17. How do we implement Graph API?
18. What is the Spread Operator in ReactJS?
19. Why do we use functional components?
20. Can we use state inside a functional component? What is the syntax?
21. How do we use `useEffect` in React?
22. Have you created a field set/custom button?
23. What is the recommended approach from Microsoft for using functional components or class components in SPFX React?
24. Have you used Copilot?
25. What is Copilot Studio Designer?
26. How do we use Adaptive Cards in a Chat Bot in Power Virtual Agent?
27. How do we use Azure SQL in a project/flow?
28. How do we use PnP to get SharePoint list data as a stream?
29. What is the maximum duration for which an Azure Function can run? Is there a way to increase the timeout?
30. How do we show a PowerApps solution to Office?
31. How do we connect Azure SQL Server with PowerApps?
32. How do we implement localization (e.g., German, Hindi, English) in PowerApps?
33. How do we create a responsive PowerApps application?
34. What is the SPBatch command in SPFX?
35. What have you done in a modern site?
36. What is a Community Hub in a modern site?
37. How do we design a List View in a modern site?
38. What new list templates were introduced in modern sites?
39. What is the Space feature in a modern site?
40. How do we get current user details and their assigned groups using PnP?
41. How do we check if the current site is a site or a web in an SPFX solution?
42. How do we access any list in the root web from a subsite?
43. How do we call one Azure Function inside another Azure Function?
44. How do we pass parameters and send back values in an Azure Function?
45. How do we access a list to perform CRUD operations but throw an "Access Denied" issue when navigating to the list/content directly?
46. How do we configure search to get records from the current site collection?
47. How do we customize an SP List view in both modern and classic sites?
48. How do we update a list item in Power Automate without updating the system time, preserving user information?
49. How do we call a flow/PowerApps using PowerShell? How do we trigger it from PowerShell?
50. What happens if we convert from classic to modern in terms of groups?
51. How do we check a user’s group in SharePoint using PowerShell/PnP?
52. What is the difference between `package.json` and `package-lock.json`?
53. What is the difference between an arrow function and a normal function in React?
54. What is the difference between a Microsoft 365 group and a Security group?
55. How do we get items exceeding 5000 records in PowerApps?
56. How do we implement a Promise in AJAX?
57. How do `resolve` and `return` work in jQuery?
58. How do we get information from multiple lists using AJAX?
59. How do we use `forEach` with an array in AJAX?
60. How do we pass a response in the `.then` method in AJAX?
61. What is the difference between a public and private team?
62. Can we deploy a WSP to SharePoint Online?
63. How do we migrate from SharePoint 2013/2016 to Online?
64. How do we check a file name in an event receiver?
65. What is the difference between SharePoint REST API and "Get List Items"?
66. If we can call any method asynchronously, when do we require a Promise?
67. What are promoted actions in SharePoint Online?
68. What are all delegate functions in PowerApps?
69. What is cross-site publishing?
70. What is the difference between `setState` and `forceUpdate`?
71. How many results do we get from a GET request from SQL?
72. How do we add a custom button in a list view using SPFX?
73. How do we compare date fields in a REST API?
74. What are the ways to create synchronous events in SharePoint Online, like event handlers?
75. What are the types of variables in PowerApps?
76. What is the difference between `Set` and `Collect` functions in PowerApps?
77. How do we create a repeating table in PowerApps, similar to InfoPath?
78. How do we store an array of a collection to a list in PowerApps?
79. How do we update values in PowerApps using the `Patch` function? What is the syntax?
80. How do we get 10000 records in PowerApps? What are the ways to achieve this?
81. How do we get more than 10000 records in MS Flow?
82. What is the total item count returned from "Get List Items" in MS Flow?
83. How do we provide a popup on every page load in PowerApps?
84. How do we increase a count on every page visit and show it on a PowerApps page?
85. What is a component in PowerApps?
86. Have you created any custom trigger?
87. How do we add a web part property in SPFX?
88. How do we add a new button in SPFX?
89. What is the SPFX architecture?
90. How do we implement a customized search in SPFX?
91. How do we configure Microsoft Search?
92. How do we create a Teams web part?
93. If my instances are running and I stop the flow, what will happen to those flows?
94. How do we capture running instances of a workflow if we want to migrate?
95. How do we create a function to create a data source in PowerApps?
96. How do we implement a People Picker control in SPFX?
97. How do we store data in multiple lists (one with a collection of arrays and another with textbox values) simultaneously in SPFX and display a final success message?
98. How do we implement Office UI Fabric usage?
99. How do we handle required field validation and error handling in SPFX?
100. How do we add a custom field property panel in SPFX?
101. How do components communicate with each other in React?
102. How do we handle long-running scripts in SPFX?
103. How do we get the current context in SPFX?
104. How do we include a client-side file in PowerShell?
105. How do we handle errors in an SPFX web part?
106. What are out-of-box web parts in modern sites?
107. How do we add a vertical in modern search?
108. What are offline capabilities in PowerApps?
109. How do we implement a business process workflow in PowerApps?
110. How do we create dynamic controls in PowerApps?
111. What is impersonation in SPFX?
112. What is a library in SPFX?
113. How do we check if full width is available in a Team Site for SPFX?
114. What is the difference between `IsBlank()` and `IsEmpty()` in PowerApps?
115. How do we schedule tasks in Azure?
116. What is the difference between publishing features in SP Modern and SP On-Premises?
117. How do we debug an SPFX solution?
118. How do we pass parameters in PowerApps and read them on the navigated screen?
119. How do we bind data from two lists into a single gallery in PowerApps?
120. How is a response received from MS Flow back to PowerApps?
121. What is the difference between `Collect` and `ClearCollect` in PowerApps?
122. What are environment variables in PowerApps solutions?
123. What is a child flow in PowerApps solutions?
124. How do we schedule Azure PowerShell scripts?
125. What are modern Team Site features?
126. How do we call multiple async methods in SPFX?
127. What is the difference between a Higher-Order Component (HOC) and a stateless component?
128. How many times is `ComponentDidMount` called in an application?
129. Which is called first—Constructor or Render?
130. How do we display a chart in PowerApps from an SP list?
131. How do we schedule Web Jobs in Azure?
132. How do we print a PDF in a modern SPFX web part?
133. How do we implement search in the modern experience (not classic)?
134. Is it possible to import a custom CSS file and apply it to an SPFX solution?
135. What is the limit on document upload size in a modern site?
136. What is an Observable in limit?
137. What is the list attachment size in an SP list?
138. What is the versioning limit in a modern list and library?
139. How does a SharePoint document get stored in a SQL database?
140. Can `ComponentDidMount` be called multiple times in SPFX/React?
141. What is the difference between Read and View permissions?
142. How do we make a full-width file in SPFX?
143. How do we make PowerApps responsive?
144. What are Azure Functions?
145. How do we get the current context for the current site collection?
146. How do we check if a site collection exists?
147. How do we retrieve lookup fields in SPFX?
148. How do we add multiple items to a list using a batch in SPFX?
149. How do we fetch list items from another site collection using PnP JS?
150. How do we make a PnP function asynchronous in an SPFX framework?
151. How do we use delegation in PowerApps/SPFX?
152. How do we create a custom component in PowerApps?
153. How do we create a custom button in a list item action in a modern list view?
154. How do we create a command ribbon button in a list/library?
155. How do we trigger a flow from an SP list or page?
156. How do we pass parameters from parent to child in React?
157. How do we pass data from child to parent using callbacks in React?
158. How do we use the Context API to share data between components?
159. How do we read a multiline rich textbox value from a SharePoint list in React?
160. How do we perform a POST request in SPFX REST API?
161. What is an Azure Automation account?
162. How do we get the current user using JSOM?
163. What is the structure of a YAML pipeline?
164. What are pipeline stages in Azure DevOps?
165. What are jobs in a pipeline?
166. What are agents in Azure DevOps?
167. What are templates in Azure DevOps?
168. What is an Office 365 E5 Developer Subscription?
169. How do we apply `Top` and `OrderBy` in SPFX PnP?
170. What is the difference between Search API and REST API in SharePoint?
171. What are Power Pages?
172. What is a Modal Driven App? How do we use it? What are its features?
173. What is a Service Principal?
174. How do we define user permissions based on roles in Power Automate?
175. What is the difference between Dataverse and SQL?
176. How do we create a mockup drawing in Power Pages?
177. How do we apply CSS in PowerApps?
178. What is SPFX Fast Serve?
179. What is a Premium Connector?
180. How do we apply site branding automatically using Power Automate?
181. How do we bring large data (e.g., 50K records) into PowerApps?
182. How do we implement lazy loading in PowerApps?
183. How do we handle delegation limits in PowerApps/MS Flow?
184. How do we create a solution in PowerApps?
185. How do we use Power Automate for external sharing (e.g., if a site is not externally shared, how do we handle it)?
186. What are delegate services?
187. How do we integrate a Yammer group in Power Automate?
188. How do we integrate Viva Engagement in Power Automate?
189. How do we use Azure Blob Container?
190. How do we implement a search lookup filter?
191. What is a Hub Site?
192. How do we change search verticals in SharePoint Online?

---

### Questions With Answers

1. **What basically happens when we create modern sites in terms of groups? How is it managed?**
   - Answer: When a modern site is created, an Owner, Member, and Guest group is created. These are managed via Office 365 Groups.

2. **What are the new templates introduced in modern sites?**
   - Answer: The new templates introduced in modern sites are:
     - SITE TEMPLATE #1: Team Site (with an Office 365 Group)
     - SITE TEMPLATE #2: Communication Site
     - SITE TEMPLATE #3: Team Site without an Office 365 Group
     - SITE TEMPLATE #4: Classic (Legacy) Sites

3. **How do we design a modern site header, footer, and navigation?**
   - Answer: Modern site header and footer design changes, along with navigation, can be achieved using SPFx extensions to inject custom CSS or JavaScript.

4. **How do we get manager details in PowerApps?**
   - Answer: Use the formula: `Office365Users.ManagerV2(DataCardValue10_1.Selected.Email)`

5. **How do we get logged-in user details in PowerApps?**
   - Answer: Use the formula: `Office365Users.MyProfileV2().mail`

6. **What is the command for connecting Azure AD and SharePoint Online?**
   - Answer: 
     - Install the module: `Install-Module -Name AzureAD`
     - Connect: `Connect-AzureAD -Credential (Get-Credential)`
     - Get users from Azure AD: `Get-AzureADUser | Export-Csv -Path "C:\Temp\AllUsers.csv" -NoTypeInformation`
     - Get users from SP Online: `Get-SPOUser -Site https://contoso.sharepoint.com/sites/finance`

7. **How do we create custom master pages in SharePoint Online?**
   - Answer: 
     - In Modern SharePoint, you cannot customize master pages or page layouts, nor edit CSS directly. Instead, use theming and site designs. For custom snippets, use SPFx to add headers, footers, or custom web parts.
     - In the Classic experience, custom master pages are possible but not supported by Microsoft; you must maintain them yourself. Custom page layouts and SPFx web parts are supported.

8. **In Power Automate, is the "From (Send as)" email option available to send emails on behalf of another user apart from the connection used in Outlook?**
   - Answer: Yes, but you need to create a user in a shared mailbox:
     - Go to Admin Center > Exchange Admin Center > Exchange > Recipients > Groups > Add Group > Manage Delegates > Add Delegate.
     - Select "Send as" and "Send on behalf" options.
     - In Power Automate, use the group name to send emails. If you get the error "You are not authorized to send email on behalf of the specified sending account," add the "Created By" user as "Send as" in the "Send an email" action.

9. **What is the difference between a functional component and a class component?**
   - Answer:
     - **Functional Component**: A plain JavaScript function that accepts props and returns a React element (JSX). No render method, stateless by default, runs top-to-bottom, and can use hooks (e.g., `useState`) to manage state.
     - **Class Component**: Extends `React.Component`, requires a `render()` method, is stateful, and supports lifecycle methods (e.g., `componentDidMount`). Uses constructors for state initialization.

10. **How do we debug a production solution in SPFX?**
    - Answer: Two options:
      - **Option 1**: Production bundles are minimized. Use "Pretty-print this minified file?" in the browser to transform the code into readable format for debugging.
      - **Option 2**: Spin up a local development environment with `gulp serve --nobrowser`, append `?loadSPFX=true&debugManifestsFile=https://localhost:4321/temp/manifests.js` to the URL, and click "Load debug scripts" to load the web part locally without affecting others.

11. **How do we consume an external API in SharePoint SPFX?**
    - Answer:
      - **Step 1**: Get an access token:
        ```javascript
        var accesstoken = "";
        var apiParameter = {
            "url": "https://apibankingsandbox.icicibank.com/clientcredential/generateaccessToken",
            "method": "Post",
            "headers": {
                "Authorization": "Basic",
                "Content-Type": "application/json",
                "Access-control-allow-origin": "*"
            },
            "data": { "grant_type": "client_credentials" }
        };
        $.ajax(apiParameter).done((res) => {
            accesstoken = res.access_token;
        });
        ```
      - **Step 2**: Call the API to get data:
        ```javascript
        $.ajax({
            "url": "https://apibank.icicibank.com/myapproval/hrms",
            "method": "Post",
            "headers": {
                "apikey": "secred_id",
                "Authorization": "Bearer " + accesstoken,
                "Content-Type": "application/json",
                "Access-control-allow-origin": "*"
            },
            "data": JSON.stringify({ "EMPID": "2323" }),
            "success": function(apires) { console.log(apires.empName); },
            "error": function(xhr, status, err) { console.log(err); }
        });
        ```

12. **How do we get a SharePoint Online access token in .NET Core?**
    - Answer:
      - **Step 1**: Register the app on the SharePoint site collection at `https://mysite.sharepoint.com/sites/demo/_layouts/15/appregnew.aspx`. Generate Client ID and Client Secret, provide a title, app domain, and redirect URI.
      - **Step 2**: Install the app at `https://mysite.sharepoint.com/sites/demo/_layouts/15/appinv.aspx` using the Client ID, and add permission XML:
        ```xml
        <AppPermissionRequests AllowAppOnlyPolicy="true">
           <AppPermissionRequest Scope="http://sharepoint/content/sitecollection" Right="FullControl" />
        </AppPermissionRequests>
        ```
      - **Step 3**: Use the Client ID and Secret in .NET Core to access site resources. The app is valid for 1 year.

13. **How do we consume the Graph API?**
    - Answer:
      - Register an app in Azure AD, generate a Client ID and Client Secret, and add permissions (e.g., `Sites.FullControl.All`).
      - Get an access token via `https://login.microsoftonline.com/{tenantid}/oauth2/token`.
      - Use the token to perform operations on lists, libraries, or sites.

14. **What is a polyfill used for?**
    - Answer: A polyfill provides modern functionality to older browsers by checking if an API is supported and using a custom implementation if not, with minimal overhead.

15. **What are all extensions available in SPFX?**
    - Answer:
      - **Application Customizers**: Add scripts and extend HTML placeholders with custom renderings.
      - **Field Customizers**: Modify views of data for fields in a list.
      - **Command Sets**: Extend SharePoint command surfaces with new actions and client-side behaviors.
      - **Form Customizer**: Override default list/library forms with custom forms tied to content types.

16. **What is the new extension introduced in SPFX?**
    - Answer: Form Customizer.

17. **What are all attributes returned by the `currentUser` context in SPFX PnP?**
    - Answer: Using `sp.web.currentUser.get()`:
      - `Email: string`
      - `Id: number`
      - `IsHiddenInUI: boolean`
      - `IsShareByEmailGuestUser: boolean`
      - `IsSiteAdmin: boolean`
      - `LoginName: string`
      - `PrincipalType: number`
      - `Title: string`

18. **How do we get the current user's groups in SPFX?**
    - Answer:
      ```javascript
      sp.web.currentUser.groups.get().then((r: any) => {
          let grpNames = "";
          r.forEach((grp) => {
              grpNames += "<li>" + grp["Title"] + "</li>";
          });
      });
      ```

19. **What is the impact of giving end users provision to create a Team in MS Teams?**
    - Answer:
      - Creates an Office 365 Group with an associated SharePoint site.
      - Creates an Exchange mailbox.
      - Initially makes the SharePoint site inaccessible to records managers unless changed.
      - Deleting the Team, SharePoint site, or Office 365 Group complicates cleanup.
      - Recommendation: Disable Office 365 Group creation for end users except Global Admins.

20. **How do we disconnect a SharePoint site from an Office 365 group?**
    - Answer: Go to Settings > Site Information > Delete Site. For team sites, confirm deletion of the Office 365 group and site, then click Delete.

21. **What is the difference between Teams and Channels?**
    - Answer:
      - **Team**: Provisions a SharePoint site collection and Office 365 Group. Users are members with access to the site (like a house with keys).
      - **Channel**: Subsections within a Team (like rooms in the house), can be public or private.

22. **How do we access ULS logs in SharePoint Online?**
    - Answer: ULS logs are no longer accessible in SharePoint Online; you must contact Microsoft support to retrieve them.

23. **What is the difference between a Team Site and a Communication Site?**
    - Answer:
      - **Team Site**: For collaboration, tied to an Office 365 Group, public by default, all members are authors.
      - **Communication Site**: For broadcasting content, no Office 365 Group, private by default, few authors and many readers.

24. **What is Distributed Cache Service if deactivated in SharePoint Online?**
    - Answer: Distributed Cache Service (DCS) supports user profiles, authentication, newsfeeds, and security trimming. Deactivating it is not recommended as it impacts performance and functionality. Memory allocation can be adjusted using `Update-SPDistributedCacheSize`.

25. **What command gets all site collections and subsites in any environment?**
    - Answer:
      ```powershell
      $SiteURL = "https://crescent.sharepoint.com/"
      $Cred = Get-Credential
      Connect-PnPOnline -Url $SiteURL -Credentials $Cred
      $SitesCollection = Get-PnPTenantSite
      ForEach($Site in $SitesCollection) {
          Write-host -F Green $Site.Url
          Connect-PnPOnline -Url $Site.Url -Credentials $Cred
          $SubSites = Get-PnPSubWeb -Recurse
          ForEach ($web in $SubSites) {
              Write-host `t $Web.URL
          }
      }
      ```

26. **How many days will a site/subsite be available after deletion?**
    - Answer:
      - Deleted sites are retained for 93 days.
      - Deleting a site deletes the group and its resources (mailbox, calendar, Teams channels).
      - Deleted Microsoft 365 groups are retained for 30 days.
      - To reuse a URL, permanently delete the site using `Remove-SPODeletedSite`.

27. **How do we manage large lists and libraries in SharePoint Online?**
    - Answer: You can store up to 30 million items. Filtered views work like smaller lists, but views exceeding 5000 items may hit the list view threshold error.

28. **How do we overcome the list view threshold in SharePoint Online?**
    - Answer:
      - Edit the list view:
        - Remove sorting (`First sort by the column` and `Then sort by the column` set to None).
        - Remove grouping (`First group by the column` and `Then group by the column` set to None).
        - Set all columns in the Totals section to None.
        - Display only one column to avoid threshold errors with certain column types.

29. **How do we change font size in a modern site?**
    - Answer: Use SPFx extensions to inject custom CSS:
      ```typescript
      export default class HelloWorldApplicationCustomizer extends BaseApplicationCustomizer<IHelloWorldApplicationCustomizerProperties> {
          @override
          public onInit(): Promise<void> {
              const head: any = document.getElementsByTagName("head")[0] || document.documentElement;
              let customStyle: HTMLLinkElement = document.createElement("link");
              customStyle.href = this.context.pageContext.site.absoluteUrl + "/SiteAssets/custom.css";
              customStyle.rel = "stylesheet";
              customStyle.type = "text/css";
              head.insertAdjacentElement("beforeEnd", customStyle);
              return Promise.resolve();
          }
      }
      ```

30. **How do we get a SharePoint usage report in SharePoint Online?**
    - Answer: Go to Gear Icon > Site Usage. It provides graphs and counts of total visits for 7/30/90 days, available by default with no feature activation required.

31. **What are page layouts in SharePoint Online?**
    - Answer:
      - **Home Page Layout**: Default for the site home page, no top banner.
      - **Article Page Layout**: Default for modern pages with a top banner.
      - **Single Part App Page Layout**: Hides the top banner, supports a single web part or Teams app, not editable via browser.
      - Change layout using PnP PowerShell:
        ```powershell
        $SiteURL = "https://crescent.sharepoint.com/sites/knowledgehub"
        $PageName = "Home.aspx"
        $PageLayout = "Article" # Options: Home, Article, SingleWebPartApp
        Connect-PnPOnline -Url $SiteURL -Interactive
        Set-PnPPage -Identity $PageName -LayoutType $PageLayout
        ```

32. **What is the use of `New-PnPUPABulkImportJob`?**
    - Answer: Extracts mapped properties from Azure AD to JSON and updates user profile attributes in bulk:
      ```powershell
      New-PnPUPABulkImportJob -Url "https://{tenant}.sharepoint.com/Shared Documents/profiles.json" -IdProperty "IdName" -UserProfilePropertyMapping @{"Department"="Department"}
      ```

33. **How do we pass parameters from child to parent in React?**
    - Answer:
      - **Parent**:
        ```javascript
        handleLanguage = (langValue) => {
            this.setState({ language: langValue });
        }
        <SelectLanguage onSelectLanguage={this.handleLanguage} />
        ```
      - **Child**:
        ```javascript
        handleLangChange = () => {
            var lang = this.dropdown.value;
            this.props.onSelectLanguage(lang);
        }
        <DropdownList ref={(ref) => this.dropdown = ref} data={jsonArray} onChange={this.handleLangChange} />
        ```

34. **What is the difference between Edit and Contribute permissions?**
    - Answer:
      - **Contribute**: View, add, update, and delete list items and documents.
      - **Edit**: Same as Contribute, plus add, edit, and delete lists.

35. **How do we handle errors in PowerApps?**
    - Answer: Enable Formula-level error management in Settings > Advanced Settings, then use `IfError`:
      ```powerapps
      IfError(
          Patch(Feedbacks, First(Feedbacks), {'Name': txtName.Text, 'Email': txtEmail.Text, 'Description': txtDesc.Text, 'Rating': txtRating.Text}),
          Notify("Some error occurred while submitting. Please try again.")
      )
      ```

36. **How do we check for blank values in PowerApps?**
    - Answer: Use `IsBlank`:
      ```powerapps
      If(IsBlank(EditForm1.Error), DisplayMode.Edit, Disabled)
      ```

37. **How do we show notifications in PowerApps?**
    - Answer: Use `Notify`:
      ```powerapps
      Notify("Event Registration Form Submitted Successfully", NotificationType.Success)
      ```

38. **How many types of connectors are there in PowerApps?**
    - Answer: Two types: Standard and Premium.

39. **Is external sharing enabled by default in Team Sites but not in Communication Sites?**
    - Answer: Yes.

40. **Which is created first when we create a modern Team Site—group or site?**
    - Answer: The Office 365 Group is created first, followed by the site.

41. **What happens if we delete the group of a modern Team Site?**
    - Answer: Nothing happens to the site immediately; it remains intact. However, deleting the Team deletes the mailbox, calendar, SharePoint site, and affiliated resources (OneNote, Planner, Power BI, Stream).

42. **How do we call a flow from a custom button?**
    - Answer: Create a button in a SharePoint list view using column formatting with JSON to trigger the flow.

43. **How do we create a retention policy in a modern site?**
    - Answer:
      - Log in to Office 365 as a Global Admin, go to Security & Compliance Center > Data Management > Retention > Create.
      - Set retention period (days, months, years), base it on Created Date or Last Modified Date, and choose to keep or delete content after expiration.
      - Apply to Exchange, SharePoint, OneDrive, or Office 365 Groups.

44. **What is the difference in hierarchy between SP Online and SP On-Premises?**
    - Answer: In On-Premises, you can create web applications; in Online, you can only create site collections.

45. **How do we check the version of an SPFX solution?**
    - Answer: Use `npm ls -g --depth=0` globally, or specifically for SPFX: `npm ls -g --depth=0 @microsoft/generator-sharepoint`.

46. **What does a retention policy specify in SharePoint?**
    - Answer: It specifies that a document will be deleted a certain time after creation or modification. Applied to a site, it affects all documents, including those created before the policy.

47. **What new field type was introduced in modern sites?**
    - Answer: Location type.

48. **How do we manage SPFX package app deployment for specific users only?**
    - Answer: Set `skipFeatureDeployment` to `true` in `package-solution.json` to make SPFx components immediately available tenant-wide upon installation to the app catalog.

49. **How do we achieve impersonation in SPFX to modify a list without giving the user direct access?**
    - Answer: Use a remote server-side API (e.g., Azure Function) with app registration to perform operations, as client-side solutions cannot elevate permissions.

50. **How do we run with elevated privileges in SPFX?**
    - Answer: SPFX doesn’t support app-only authentication directly, but you can use Power Automate with an app-only token:
      - User triggers an HTTP POST via SPFx to call a flow.
      - The flow retrieves an access token from ACS and performs the REST API call.

51. **Why should we use state instead of normal variables in React?**
    - Answer: Updating state triggers a re-render to reflect changes in the UI, while normal variables do not:
      ```javascript
      function Foo() {
          let a = 0;
          a = 1; // No re-render
          return <div>{a}</div>;
      }
      function Foo() {
          const [a, setA] = useState(0);
          if (a != 1) setA(1); // Triggers re-render
          return <div>{a}</div>;
      }
      ```

52. **What is the React lifecycle?**
    - Answer:
      - **Mounting**: `constructor()`, `static getDerivedStateFromProps()`, `render()`, `componentDidMount()`.
      - **Updating**: `static getDerivedStateFromProps()`, `shouldComponentUpdate()`, `render()`, `getSnapshotBeforeUpdate()`, `componentDidUpdate()`.
      - **Unmounting**: `componentWillUnmount()`.
      - **Error Handling**: `static getDerivedStateFromError()`, `componentDidCatch()`.

53. **What is the SPFX lifecycle?**
    - Answer:
      - `onInit()`: Start method for initialization.
      - `componentWillMount()`: Runs before render for initial data pulls.
      - `componentDidMount()`: Runs after render for pre-populating controls.
      - `componentDidUpdate()`: Runs on property/state updates.
      - `render()`: Renders the final HTML based on state.

54. **In which class does an SPFX class inherit?**
    - Answer: `BaseClientSideWebPart` (e.g., `export default class ClaimsidWebPart extends BaseClientSideWebPart<IClaimsidWebPartProps>`).

55. **How many times is `ComponentDidMount` called in React?**
    - Answer: By default, once after the initial render. It can be called multiple times if the component’s `key` prop changes.

56. **How do we get all sites and subsites?**
    - Answer:
      ```powershell
      $credentials = Get-Credential
      $URL = "https://tenant-admin.sharepoint.com"
      Connect-PnPOnline -Url $URL -Credentials $credentials
      $siteColl = Get-PnPTenantSite
      foreach($site in $siteColl) {
          Connect-PnPOnline -Url $site.Url -Credentials $credentials
          $subSites = Get-PnPSubWeb -Recurse
          foreach($sub in $subSites) {
              Write-Host $sub.Url
          }
      }
      ```

57. **How do we get subsites of a site using PowerShell PnP?**
    - Answer:
      ```powershell
      $SiteURL = "https://crescenttech.sharepoint.com"
      $Cred = Get-Credential
      Connect-PnPOnline -Url $SiteURL -Credentials $Cred
      $WebsCollection = Get-PnPSubWebs -Recurse
      ForEach($Web in $WebsCollection) {
          Write-host $Web.Url
      }
      ```

58. **How do we get all site collection admins?**
    - Answer:
      ```powershell
      $credentials = Get-Credential
      $siteColl = Get-PnPTenantSite
      foreach($site in $siteColl) {
          Connect-PnPOnline -Url $site.Url -Credentials $credentials
          $scaColl = Get-PnPSiteCollectionAdmin
          foreach($sca in $scaColl) {
              $sca
          }
      }
      ```

59. **How do we create a new site collection?**
    - Answer:
      ```powershell
      New-PnPTenantSite -Title "Contoso" -Url "https://tenant.sharepoint.com/sites/contoso" -Owner "user@example.org" -TimeZone 4 -Template STS#0
      ```

60. **What is the difference between a modern Team Site and a Communication Site?**
    - Answer:
      - **Team Site**: For collaboration, tied to an Office 365 Group, public by default, all members are authors.
      - **Communication Site**: For content broadcasting, no Office 365 Group, private by default, few authors and many readers.

61. **How do we create a custom CSS style and inject it into modern pages?**
    - Answer: Use SPFx extensions (see font size change example above).

62. **What happens when creating a Team Site from the admin center?**
    - Answer: Only Private and Public privacy options are available; no SharePoint groups are created. Subsites within the site collection create SharePoint groups.

63. **What options are available when creating a group from the admin center?**
    - Answer: Microsoft 365, Distribution, Mail-enabled Security, Security. You can choose to associate a Team with the group.

64. **How do we use SP Batch commands in SharePoint?**
    - Answer:
      ```javascript
      const list = sp.web.lists.getByTitle('MyCustomList');
      const ent = await list.getListItemEntityTypeFullName();
      const batch = sp.web.createBatch();
      const items = list.items.inBatch(batch);
      items.add({ Title: 'Item 1' }, ent).catch(console.warn);
      items.add({ Title: 'Item 2' }, ent).catch(console.warn);
      await batch.execute();
      console.log('Done');
      ```
